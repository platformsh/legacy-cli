# This file defines one application within your project. Each application is rooted
# at the directory where this file exists, and will produce a single application
# container to run your code.  The basic file below shows the key options available,
# but wil likely need additional customization for your application.
# See URL for more information.

# The name of this app. Must be unique within a project.
name: '{{ application_name }}'

# Configuration of the build of this application.
type: '{{ runtime }}:{{ runtime_version }}'

{% include 'includes/relationships.yaml.twig' %}

# Dependencies list tools that are not part of your application but that are needed
# to build or run it.
dependencies:
  nodejs:
    pm2: "^0.15.10"

web:
  # The commands section lists programs to start when the container is deployed,
  # typically starting your node application.
  commands:
    start: "PM2_HOME=/app/run pm2 start index.js --no-daemon"
    #in this setup you will find your application stdout and stderr in /app/run/logs
  locations:
    "/public":
      passthru: false
      root: "public"
      # Whether to allow files not matching a rule or not.
      allow: true
      rules:
        '\.png$':
          allow: true
          expires: -1

# The size in megabytes of persistent disk space to reserve as part of this application.
disk: {{ application_disk|yaml }}

# Each mount is a pairing of the local path on the application container to
# the persistent mount where it lives. At this time, only 'shared:files' is
# a supported mount.
mounts:
  "/run": "shared:files/run"

{% include 'includes/crons.yaml.twig' %}
