# This file describes an application. You can have multiple applications
# in the same project.
#
# See https://docs.platform.sh/user_guide/reference/platform-app-yaml.html

{% block name %}
# The name of this app. Must be unique within a project.
name: '{{ application_name }}'
{% endblock %}

{% block type %}
# Configuration of the build of this application.
type: '{{ runtime }}:{{ runtime_version }}'
{% endblock %}

{% block dependencies %}
# The build-time dependencies of the app.
#dependencies:
#    nodejs:
#        "gulp": "^1.0"
{% endblock %}

{% block disk %}
# The size of the persistent disk of the application (in MB).
disk: {{ application_disk|yaml }}
{% endblock %}

{% include 'includes/relationships.yaml.twig' %}

{% block build %}
{% if build_flavor %}
# Configuration of the build of this application.
build:
    flavor: {{ build_flavor|yaml }}
{% else %}
#build:
#    flavor: none
{% endif %}
{% endblock %}

{% block web %}
# The configuration of app when it is exposed to the web.
web:
    # Specific parameters for different URL prefixes.
    locations:
        '/':
            # Whether to forward disallowed and missing resources from this
            # location to the application.
            #
            # Can be true, false or a URI path string.
            passthru: '{{ front_controller }}'
            # The folder from which to serve static assets, for this location.
            #
            # This is a filesystem path, relative to the application root.
            root: '{{ webroot }}'
            # Deny access to static files in this location.
            allow: false
        '/uploads':
            # Allow access to all files in the public files directory.
            allow: true
            expires: 5m
            passthru: '{{ front_controller }}'
            root: '{{ webroot }}/uploads'
            # Do not execute PHP scripts.
            scripts: false
{% endblock %}

{% block hooks %}
{% endblock %}

{% block mounts %}
# The mounts that will be performed when the package is deployed.
mounts:
    "/{{ webroot }}/uploads": "shared:files/public-uploads"
    "/private": "shared:files/private"
{% endblock %}

{% include 'includes/crons.yaml.twig' %}
